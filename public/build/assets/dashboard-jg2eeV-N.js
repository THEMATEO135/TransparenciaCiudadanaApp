document.addEventListener("DOMContentLoaded",function(){new Chart(document.getElementById("chartServicios"),{type:"bar",data:{labels:window.labelsServicios,datasets:[{label:"Reportes por Servicio",data:window.valoresServicios,backgroundColor:"rgba(54, 162, 235, 0.7)",borderRadius:6}]}}),new Chart(document.getElementById("chartMeses"),{type:"line",data:{labels:window.labelsMeses,datasets:[{label:"Reportes por Mes",data:window.valoresMeses,borderColor:"rgba(255, 99, 132, 1)",backgroundColor:"rgba(255, 99, 132, 0.2)",fill:!0,tension:.3}]}});var e=L.map("map").setView([4.6097,-74.0817],6);L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; OpenStreetMap &copy; <a href="https://carto.com/">CARTO</a>',subdomains:"abcd",maxZoom:19}).addTo(e);var a=window.coordenadas||[],t="heatmap",r=a.map(e=>[e.lat,e.lng,.8]),n=null;r.length>0&&(n=L.heatLayer(r,{radius:50,blur:25,minOpacity:.4,maxZoom:10,max:1,gradient:{0:"blue",.3:"cyan",.5:"lime",.7:"yellow",1:"red"}}).addTo(e));var o=L.layerGroup();if(a.forEach(e=>{L.circleMarker([e.lat,e.lng],{radius:8,color:"#ff0000",fillColor:"#ff0000",fillOpacity:.8}).bindPopup(`<b>Reporte:</b> ${e.servicio??"N/A"}`).addTo(o)}),a.length>0){var s=L.latLngBounds(a.map(e=>[e.lat,e.lng]));e.fitBounds(s,{padding:[50,50]})}document.getElementById("btnHeatmap").addEventListener("click",function(){"heatmap"!==t&&n&&(e.removeLayer(o),e.addLayer(n),t="heatmap",this.classList.remove("btn-secondary"),this.classList.add("btn-primary"),document.getElementById("btnMarkers").classList.remove("btn-primary"),document.getElementById("btnMarkers").classList.add("btn-secondary"))}),document.getElementById("btnMarkers").addEventListener("click",function(){"markers"!==t&&(n&&e.removeLayer(n),e.addLayer(o),t="markers",this.classList.remove("btn-secondary"),this.classList.add("btn-primary"),document.getElementById("btnHeatmap").classList.remove("btn-primary"),document.getElementById("btnHeatmap").classList.add("btn-secondary"))}),setTimeout(()=>{e.invalidateSize()},400)});
